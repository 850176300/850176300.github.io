window.__require=function t(e,n,o){function i(r,l){if(!n[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var s="function"==typeof __require&&__require;if(!l&&s)return s(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var p=n[r]={exports:{}};e[r][0].call(p.exports,function(t){return i(e[r][1][t]||t)},p,p.exports,t,e,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({AdCom:[function(t,e,n){"use strict";cc._RF.push(e,"5cc98IeW2dHgZcSWD9e+oBj","AdCom"),n.__esModule=!0;var o=function(){function t(){}return t.buyGold=function(t){t(!0)},t.watchAD=function(t){t(!0)},t}();n.default=o,cc._RF.pop()},{}],AvatarUI:[function(t,e,n){"use strict";cc._RF.push(e,"a50c7RmoWNDqJUZnI64FIeQ","AvatarUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/ConfigsManager"),r=t("../Com/List"),l=t("../Com/GameData"),c=t("../Com/AdCom"),s=t("./NewSkinUI"),p=t("../SceneLogic/GameScene"),u=cc._decorator,h=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gray=null,e.normal=null,e.avatarAtlas=null,e.newSkinUI=null,e.cloneList=new r.default,e.currentID=0,e}return o(e,t),e.prototype.onLoad=function(){var t=this;cc.find("title/close",this.node).on("click",function(e){t.node.active=!1});var e=cc.find("gold",this.node),n=cc.find("get",this.node),o=cc.find("buy",this.node);e.on("click",function(e){c.default.buyGold(function(e){l.default.GetInstance().AddGold(500),t.start()})}),n.on("click",function(e){c.default.watchAD(function(e){if(e){l.default.GetInstance().AddSkin(t.currentID),t.start();var n=cc.instantiate(t.newSkinUI);t.node.addChild(n),n.getComponent(s.default).setCloth(t.currentID)}})}),o.on("click",function(e){var n=a.default.getInstance().avatarConfig.GetByIndex(t.currentID-1);l.default.GetInstance().AddGold(-n.price),l.default.GetInstance().AddSkin(t.currentID),t.start();var o=cc.instantiate(t.newSkinUI);t.node.addChild(o),o.getComponent(s.default).setCloth(t.currentID)});for(var i=a.default.getInstance().avatarConfig,r=cc.find("sv/view/content/item",this.node),u=function(e){var n=i.GetByIndex(e),o=cc.instantiate(r),a=e+1;o.setParent(r.parent),cc.find("icon",o).getComponent(cc.Sprite).spriteFrame=h.avatarAtlas.getSpriteFrame(n.icon);var c=o.getComponent(cc.Toggle);o.on("toggle",function(){c.isChecked&&(t.currentID=a,t.updateCurrent(),l.default.GetInstance().IsHaveSkin(a)&&(l.default.GetInstance().SetSkin(a),p.default.GetInstance().changeCloth(a)))}),h.cloneList.Add(o)},h=this,f=0;f<i.length;f++)u(f);r.active=!1},e.prototype.start=function(){for(var t=0;t<this.cloneList.length;t++){var e=this.cloneList.GetByIndex(t),n=t+1,o=(a.default.getInstance().avatarConfig.GetByIndex(t),l.default.GetInstance().skinList.Contains(n));cc.find("normal",e).getComponent(cc.Sprite).setMaterial(0,o?this.normal:this.gray),cc.find("f",e).getComponent(cc.Sprite).setMaterial(0,o?this.normal:this.gray),cc.find("icon",e).getComponent(cc.Sprite).setMaterial(0,o?this.normal:this.gray),e.getComponent(cc.Toggle).isChecked&&(this.currentID=n,this.updateCurrent())}},e.prototype.updateCurrent=function(){var t=a.default.getInstance().avatarConfig.GetByIndex(this.currentID-1),e=l.default.GetInstance().skinList.Contains(this.currentID),n=(cc.find("gold",this.node),cc.find("get",this.node)),o=cc.find("buy",this.node);cc.find("price",o).getComponent(cc.Label).string=t.price,cc.find("preview",this.node).getComponent(cc.Sprite).spriteFrame=this.avatarAtlas.getSpriteFrame(t.preview),n.active=!e&&l.default.GetInstance().gold<t.price,o.active=!e&&l.default.GetInstance().gold>=t.price},i([f(cc.Material)],e.prototype,"gray"),i([f(cc.Material)],e.prototype,"normal"),i([f(cc.SpriteAtlas)],e.prototype,"avatarAtlas"),i([f(cc.Prefab)],e.prototype,"newSkinUI"),e=i([h],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../Com/AdCom":"AdCom","../Com/GameData":"GameData","../Com/List":"List","../Managers/ConfigsManager":"ConfigsManager","../SceneLogic/GameScene":"GameScene","./NewSkinUI":"NewSkinUI"}],BallCollider:[function(t,e,n){"use strict";cc._RF.push(e,"e6374QmkXlED68R3opd8gYP","BallCollider");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=cc._decorator,c=l.ccclass,s=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collider=null,e}return o(e,t),e.prototype.start=function(){console.log(this.node.parent.name),this.collider.on("collision-enter",this.onCollisionStay,this)},e.prototype.onDestroy=function(){this.collider.off("collision-enter",this.onCollisionStay,this)},e.prototype.onCollisionStay=function(t){var e=t.selfCollider;console.log(e.node.parent.name),"AdsCollider"===e.node.parent.name?a.default.getInstance().emit(r.OperateEvent.BallReflectStayEvent,t.contacts):a.default.getInstance().emit(r.OperateEvent.BallOutsideEvent,null)},i([s(cc.BoxCollider3D)],e.prototype,"collider"),e=i([c],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter"}],BallController:[function(t,e,n){"use strict";cc._RF.push(e,"6d7b9lVm8lD3ZW0FoM5s6ab","BallController");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=t("../CameraFollow"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rigidBody=null,e.cameraFol=null,e.ballRadius=.11,e.moveDirection=new cc.Vec3(0,0,-1),e.state=r.BallState.Idle,e.followSpeed=2,e.curFollowPlayer=null,e.followFriction=.2,e.gameStart=!1,e.gamePuase=!1,e.onTouching=!1,e.sendFallEvent=!1,e.lineSpeed=cc.Vec3.ZERO,e.gameOver=!1,e.touchdown=!1,e.ballGroundDistance=cc.Vec3.ZERO,e.ballGroundSpeed=cc.Vec3.ZERO,e.framwcnt=10,e.lastLinearSpeed=cc.Vec3.ZERO,e.lastAngularSpeed=cc.Vec3.ZERO,e.invincible=!1,e}return o(e,t),e.prototype.onLoad=function(){cc.director.getPhysics3DManager().enabled=!0},e.prototype.start=function(){this.rigidBody.isKinematic=!1,this.rigidBody.allowSleep=!1,this.rigidBody.linearFactor=new cc.Vec3(.7,.4,.7),a.default.getInstance().on(r.OperateEvent.GamePauseEvent,this.onGamePuase,this),a.default.getInstance().on(r.OperateEvent.GameRestart,this.onGameRestart,this),a.default.getInstance().on(r.OperateEvent.GameContinue,this.onGameContinue,this),a.default.getInstance().on(r.OperateEvent.BallOutsideEvent,this.onBallOutside,this),a.default.getInstance().on(r.OperateEvent.YellowPlayerKickBall,this.onNPCKickBall,this),a.default.getInstance().on(r.OperateEvent.YellowPlayerGetBall,this.onNPCGetBall,this),a.default.getInstance().on(r.OperateEvent.TapStartGame,this.onTapStart,this),a.default.getInstance().on(r.OperateEvent.PlayerFollowBall,this.onPlayerFollowBall,this),a.default.getInstance().on(r.OperateEvent.BallReflectStayEvent,this.onBallStayOnAdsNode,this)},e.prototype.onDestroy=function(){a.default.getInstance().off(r.OperateEvent.GamePauseEvent,this.onGamePuase,this),a.default.getInstance().off(r.OperateEvent.GameRestart,this.onGameRestart,this),a.default.getInstance().off(r.OperateEvent.GameContinue,this.onGameContinue,this),a.default.getInstance().off(r.OperateEvent.BallOutsideEvent,this.onBallOutside,this),a.default.getInstance().off(r.OperateEvent.YellowPlayerGetBall,this.onNPCGetBall,this),a.default.getInstance().off(r.OperateEvent.YellowPlayerKickBall,this.onNPCKickBall,this),a.default.getInstance().off(r.OperateEvent.TapStartGame,this.onTapStart,this),a.default.getInstance().off(r.OperateEvent.PlayerFollowBall,this.onPlayerFollowBall,this),a.default.getInstance().off(r.OperateEvent.BallReflectStayEvent,this.onBallStayOnAdsNode,this)},e.prototype.onGamePuase=function(t){this.gamePuase=!0,this.rigidBody.getLinearVelocity(this.lastLinearSpeed),this.rigidBody.getAngularVelocity(this.lastAngularSpeed),cc.director.getPhysics3DManager().enabled=!1},e.prototype.onGameRestart=function(t){this.rigidBody.setLinearVelocity(cc.Vec3.ZERO),this.rigidBody.setAngularVelocity(cc.Vec3.ZERO),cc.director.getPhysics3DManager().enabled=!0,this.node.position=new cc.Vec3(0,this.ballRadius,18.8),this.moveDirection=new cc.Vec3(0,0,-1),this.state=r.BallState.Idle,this.followSpeed=2,this.curFollowPlayer=null,this.followFriction=.2,this.gameStart=!1,this.gamePuase=!1,this.onTouching=!1,this.sendFallEvent=!1,this.lineSpeed=cc.Vec3.ZERO,this.gameOver=!1,this.touchdown=!1,this.ballGroundDistance=cc.Vec3.ZERO,this.ballGroundSpeed=cc.Vec3.ZERO,this.framwcnt=10,this.lastLinearSpeed=cc.Vec3.ZERO,this.lastAngularSpeed=cc.Vec3.ZERO,this.invincible=!1},e.prototype.onGameContinue=function(t){this.invincible=!0;var e=this;this.scheduleOnce(function(){e.invincible=!1},5),cc.director.getPhysics3DManager().enabled=!0,this.gameStart=!0,this.gamePuase=!1,this.gameOver=!1},e.prototype.onBallStayOnAdsNode=function(){this.state===r.BallState.Follow&&this.onBallOutside()},e.prototype.onGameOver=function(){this.invincible||(a.default.getInstance().emit(r.OperateEvent.BallStartFly,null),this.gameStart=!1,this.gameOver=!0,this.state=r.BallState.Idle,this.rigidBody.setLinearVelocity(cc.Vec3.ZERO),this.rigidBody.setAngularVelocity(cc.Vec3.ZERO),cc.director.getPhysics3DManager().enabled=!1,a.default.getInstance().emit(r.OperateEvent.GameOverEvent,null))},e.prototype.onBallOutside=function(){this.gameOver||this.onGameOver()},e.prototype.onNPCKickBall=function(){this.gameOver||this.onGameOver()},e.prototype.onNPCGetBall=function(t){this.gameOver||(this.state==r.BallState.Follow&&this.canGameUpdate()?(this.onGameOver(),this.curFollowPlayer.fallGround(function(){})):(t.turnReset(),this.onGameOver()))},e.prototype.canGameUpdate=function(){return this.gameStart&&0==this.gamePuase&&0==this.gameOver},e.prototype.onMouseDown=function(t){this.touchdown=!0,this.canGameUpdate()&&this.canTouch()&&(this.onTouching=!0,this.state===r.BallState.Follow&&this.setFollowSpeed())},e.prototype.onMouseMove=function(t){if(this.canGameUpdate()&&this.canTouch()&&this.onTouching&&this.state===r.BallState.Follow){var e=t.touch,n=e.getStartLocation(),o=new cc.Vec2(1,0),i=n.signAngle(o),a=Math.floor(cc.misc.radiansToDegrees(i)),l=e.getLocation().signAngle(o),c=Math.floor(cc.misc.radiansToDegrees(l))-a,s=new cc.Quat,p=180-2.5*c;p<-80&&(p=-80),p<80&&(p=80),cc.Quat.fromEuler(s,0,p,0),this.curFollowPlayer.node.setRotation(s),this.onRotateBall(),this.curFollowPlayer.movedirection=this.moveDirection}},e.prototype.onMouseUp=function(t){if(this.touchdown=!1,this.onTouching=!1,this.canGameUpdate()&&this.canTouch()&&this.state===r.BallState.Follow){this.state=r.BallState.Flying;var e=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(e,this.moveDirection,.1);var n=this.curFollowPlayer.node.position.add(e);n.y=this.ballRadius,this.node.position=n,this.onKickOff(this.moveDirection),this.curFollowPlayer.kickOffBall(),this.curFollowPlayer=null}},e.prototype.canTouch=function(){return this.state===r.BallState.Flying&&1==this.sendFallEvent||(this.state===r.BallState.Lining||this.state===r.BallState.Follow)},e.prototype.onPlayerFollowBall=function(t){a.default.getInstance().emit(r.OperateEvent.BallStartFly,{pos:this.node.position}),this.state=r.BallState.FollowPeriod,this.rigidBody.setLinearVelocity(cc.Vec3.ZERO),this.rigidBody.setAngularVelocity(cc.Vec3.ZERO),this.curFollowPlayer=t,this.onRotateBallStart(),this.onTouching||this.touchdown?this.setFollowSpeed():(this.followSpeed=1,this.followFriction=0)},e.prototype.setFollowSpeed=function(){this.followSpeed=2.5,this.followFriction=.25,this.curFollowPlayer.followBallSpeed=2.5,this.curFollowPlayer.followBallFriction=.25},e.prototype.onRotateBallStart=function(){var t=new cc.Quat,e=cc.Vec3.ZERO;this.curFollowPlayer.node.getRotation(t),cc.Quat.toEuler(e,t);var n=Math.cos(e.y*Math.PI/180),o=Math.sin(e.y*Math.PI/180);o=Math.round(100*o)/100,n=Math.round(100*n)/100,this.moveDirection=new cc.Vec3(o,0,n);var i=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(i,this.moveDirection,.1),i.y=this.ballRadius;var a=this.curFollowPlayer.node.position.add(i);this.ballGroundDistance=a.sub(this.node.position),this.framwcnt=10,cc.Vec3.multiplyScalar(this.ballGroundSpeed,this.ballGroundDistance,1/this.framwcnt)},e.prototype.onRotateBall=function(){var t=new cc.Quat,e=cc.Vec3.ZERO;this.curFollowPlayer.node.getRotation(t),cc.Quat.toEuler(e,t);var n=Math.cos(e.y*Math.PI/180),o=Math.sin(e.y*Math.PI/180);o=Math.round(100*o)/100,n=Math.round(100*n)/100,this.moveDirection=new cc.Vec3(o,0,n);var i=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(i,this.moveDirection,.1),i.y=this.ballRadius,this.node.position=this.curFollowPlayer.node.position.add(i)},e.prototype.onTapStart=function(t){this.gameStart=!0,this.rigidBody.setLinearVelocity(new cc.Vec3(0,4,-6)),this.rigidBody.setAngularVelocity(new cc.Vec3(0,0,0)),this.state=r.BallState.Flying,this.sendFallEvent=!1,a.default.getInstance().emit(r.OperateEvent.BallStartFly,{direction:new cc.Vec3(0,0,-1)})},e.prototype.onKickOff=function(t){cc.Vec3.normalize(this.moveDirection,t);this.node.position;var e=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(e,this.moveDirection,5),this.rigidBody.setLinearVelocity(cc.Vec3.ZERO),this.rigidBody.setAngularVelocity(cc.Vec3.ZERO),this.rigidBody.setLinearVelocity(new cc.Vec3(e.x,3,e.z)),this.state=r.BallState.Flying,this.sendFallEvent=!1,a.default.getInstance().emit(r.OperateEvent.BallStartFly,{direction:new cc.Vec3(e.x,3,e.z)})},e.prototype.update=function(t){if(0!=this.canGameUpdate()){if(this.state===r.BallState.Flying){var e=cc.Vec3.ZERO;this.rigidBody.getLinearVelocity(e);var n=cc.Vec2.ZERO;if(cc.Camera.findCamera(this.node).getWorldToScreenPoint(new cc.Vec3(this.node.position.x,this.node.position.y+this.ballRadius,this.node.position.z),n),a.default.getInstance().emit(r.OperateEvent.BallIsFlying,n),e.y<0){n=cc.Vec2.ZERO;cc.Camera.findCamera(this.node).getWorldToScreenPoint(this.node.position,n),a.default.getInstance().emit(r.OperateEvent.BallStartFall,n),0==this.sendFallEvent&&(this.onTouching=this.touchdown,this.sendFallEvent=!0)}e.y<0&&this.node.position.y<this.ballRadius+.1&&(this.rigidBody.getLinearVelocity(this.lineSpeed),this.lineSpeed.y=0,this.lineSpeed.z*=.25,this.lineSpeed.x*=.25,this.state=r.BallState.Lining,a.default.getInstance().emit(r.OperateEvent.BallFallOnGround,null))}else if(this.state===r.BallState.FollowPeriod)this.node.position=this.node.position.add(this.ballGroundSpeed.add(new cc.Vec3(0,0,-2*t))),this.framwcnt=this.framwcnt-1,this.framwcnt<=0&&(this.state=r.BallState.Follow,this.curFollowPlayer.state=r.PlayerState.FollowBall,(this.onTouching||this.touchdown)&&(this.onTouching=this.touchdown,this.setFollowSpeed()));else if(this.state===r.BallState.Follow){var o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,this.moveDirection,this.followSpeed*t),this.node.position=this.node.position.add(o),this.followSpeed=this.followSpeed-t*this.followFriction,this.followSpeed<1&&(this.followFriction=0)}a.default.getInstance().emit(r.OperateEvent.GameScoreChanging,this.node.position)}},i([p(cc.RigidBody3D)],e.prototype,"rigidBody"),i([p(l.default)],e.prototype,"cameraFol"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../CameraFollow":"CameraFollow","../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter"}],BallGoal:[function(t,e,n){"use strict";cc._RF.push(e,"8329b0SciJFU4nWfczWo11Z","BallGoal");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=cc._decorator,c=l.ccclass,s=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxcollider=null,e}return o(e,t),e.prototype.start=function(){this.boxcollider.on("trigger-enter",this.onTriggerEnter,this)},e.prototype.onDestroy=function(){this.boxcollider.off("trigger-enter",this.onTriggerEnter,this)},e.prototype.onTriggerStay=function(){},e.prototype.onTriggerExit=function(){},e.prototype.onTriggerEnter=function(t){"BallNode"==t.otherCollider.node.name&&a.default.getInstance().emit(r.OperateEvent.GotoNextLevel,null)},i([s(cc.BoxCollider3D)],e.prototype,"boxcollider"),e=i([c],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter"}],CameraFollow:[function(t,e,n){"use strict";cc._RF.push(e,"02d63B7IxFM5oMNCeKOQ7dq","CameraFollow");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=cc._decorator,r=a.ccclass,l=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.followTarget=null,e.playerTarget=null,e.startPos=cc.Vec3.ZERO,e.nodeStartPos=cc.Vec3.ZERO,e}return o(e,t),e.prototype.start=function(){this.startPos=this.followTarget.position,this.nodeStartPos=this.node.position},e.prototype.lateUpdate=function(){if(null!=this.playerTarget){var t=this.playerTarget.position.sub(this.startPos),e=new cc.Vec3(t.x,0,t.z);this.node.position=this.nodeStartPos.add(e)}else{t=this.followTarget.position.sub(this.startPos),e=new cc.Vec3(t.x,0,t.z);this.node.position=this.nodeStartPos.add(e)}},e.prototype.changeToPlayer=function(t){if(this.playerTarget=t,null!=t){var e=this.playerTarget.position.sub(this.startPos),n=new cc.Vec3(e.x,0,e.z);this.node.position=this.nodeStartPos.add(n)}},i([l(cc.Node)],e.prototype,"followTarget"),e=i([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],ConfigsManager:[function(t,e,n){"use strict";cc._RF.push(e,"0db5d8HOkFOmKi1sR+BipnO","ConfigsManager");var o=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var i=t("../Com/List"),a=cc._decorator,r=a.ccclass,l=(a.property,function(){function t(){this.levelConfigs={},this.avatarConfig=new i.default}var e;return e=t,t.getInstance=function(){return e.instance||(e.instance=new e),e.instance},t.prototype.loadConfigs=function(t){var e=this;cc.loader.loadRes("Configs/levels_config",cc.JsonAsset,function(n,o){null!==o&&(e.levelConfigs=o.json,null!==t&&t())})},t.prototype.loadAvatarConfig=function(t){for(var e=0;e<t.json.length;e++)this.avatarConfig.Add(t.json[e]);console.log(this.avatarConfig)},t.prototype.getWhitePlayers=function(t){return null!==this.levelConfigs[t]?this.levelConfigs[t].white:null},t.prototype.getYellowPlayers=function(t){return null!==this.levelConfigs[t]?this.levelConfigs[t].yellow:null},t.prototype.getYellowCloth=function(t){return null!==this.levelConfigs[t]?this.levelConfigs[t].yellowCloth:2},t.prototype.getPositionFromStr=function(t){var e=t.split(",",3);return 3!==e.length?(console.log("----------\u5750\u6807\u89e3\u6790\u51fa\u9519------------"),cc.Vec3.ZERO):new cc.Vec3(parseFloat(e[0].trim()),parseFloat(e[1].trim()),parseFloat(e[2].trim()))},t=e=o([r],t)}());n.default=l,cc._RF.pop()},{"../Com/List":"List"}],EndUI:[function(t,e,n){"use strict";cc._RF.push(e,"e5abeAboWVCwaGrq+sX+Q14","EndUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../EventDefine"),r=t("../Managers/NotificationCenter"),l=cc._decorator,c=l.ccclass,s=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLable=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;cc.find("continue",this.node).on("click",function(e){t.node.active=!1,r.default.getInstance().emit(a.OperateEvent.GameContinue,null)}),cc.find("restart",this.node).on("click",function(e){t.node.active=!1,r.default.getInstance().emit(a.OperateEvent.GameRestart,null);var n=new cc.Event.EventCustom(a.UIEvents.StartUIClickStartEvent,!0);t.node.dispatchEvent(n)})},e.prototype.onGameOver=function(t){this.scoreLable.string=t.score},i([s(cc.Label)],e.prototype,"scoreLable"),e=i([c],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter"}],EventDefine:[function(t,e,n){"use strict";cc._RF.push(e,"92186U2lkxLuo+zOIc4JIZJ","EventDefine"),n.__esModule=!0,function(t){t.StartUIClickStartEvent="StartUIClickStartEvent",t.StartUIClickSettingEvent="StartUIClickSettingEvent"}(n.UIEvents||(n.UIEvents={})),function(t){t.TapStartGame="TapStartGame",t.BallFallOnGround="BallFallOnGround",t.BallStartFall="BallStartFall",t.BallStartFly="BallStartFly",t.BallIsFlying="BallIsFlying",t.PlayerFollowBall="PlayerFollowBall",t.YellowPlayerGetBall="YellowPlayerGetBall",t.YellowPlayerKickBall="YellowPlayerKickBall",t.GameOverEvent="GameOverEvent",t.GameOverScoreEvent="GameOverScoreEvent",t.GamePauseEvent="GamePauseEvent",t.BallOutsideEvent="BallOutsideEvent",t.BallReflectStayEvent="BallReflectStayEvent",t.BallReflectExitEvent="BallReflectExitEvent",t.WhitePlayerGotNextLevel="WhitePlayerGotNextLevel",t.YellowPlayerGotNextLevel="YellowPlayerGotNextLevel",t.GotoNextLevel="GotoNextLevel",t.GameContinue="GameContinue",t.GameRestart="GameRestart",t.GameScoreChanging="GameScoreChanging"}(n.OperateEvent||(n.OperateEvent={})),function(t){t[t.Idle=0]="Idle",t[t.RunBackForBall=1]="RunBackForBall",t[t.RunBackForPlayer=2]="RunBackForPlayer",t[t.Follow=3]="Follow",t[t.FinishFollow=4]="FinishFollow",t[t.FollowBall=5]="FollowBall",t[t.FollowPeriod=6]="FollowPeriod",t[t.Disabled=7]="Disabled"}(n.PlayerState||(n.PlayerState={})),function(t){t[t.Idle=0]="Idle",t[t.FollowBall=1]="FollowBall",t[t.ShiftBall=2]="ShiftBall",t[t.Disabled=3]="Disabled"}(n.NPCState||(n.NPCState={})),function(t){t[t.Idle=0]="Idle",t[t.Flying=1]="Flying",t[t.Lining=2]="Lining",t[t.FollowPeriod=3]="FollowPeriod",t[t.Follow=4]="Follow"}(n.BallState||(n.BallState={})),function(t){t[t.Idle=0]="Idle",t[t.Defense=1]="Defense",t[t.FetchBall=2]="FetchBall"}(n.NPCKeeperState||(n.NPCKeeperState={})),function(t){t[t.Start=0]="Start",t[t.Setting=1]="Setting",t[t.Game=2]="Game"}(n.UIType||(n.UIType={})),cc._RF.pop()},{}],GameData:[function(t,e,n){"use strict";cc._RF.push(e,"0a0daAxjAtJsqgqlm/WWUXz","GameData"),n.__esModule=!0;var o=t("./List"),i=t("../Managers/NotificationCenter"),a=function(){function t(){this.saveKey="game-data",this.gold=0,this.currentSkin=1,this.skinList=new o.default}return t.GetInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.Init=function(){var t=cc.sys.localStorage.getItem(this.saveKey);if(null!=t){console.log("save:"+t);var e=JSON.parse(t);this.gold=e.gold,this.currentSkin=e.currentSkin,this.skinList.InitFromJSON(e.skinList)}else this.skinList.Add(1),console.log("new player data init")},t.prototype.Save=function(){var t={gold:this.gold,currentSkin:this.currentSkin,skinList:this.skinList},e=JSON.stringify(t);cc.sys.localStorage.setItem(this.saveKey,e)},t.prototype.AddGold=function(t){this.gold+=t,this.Save(),i.default.getInstance().emit("gold_change",null)},t.prototype.AddSkin=function(t){this.skinList.Contains(t)||(this.skinList.Add(t),this.Save())},t.prototype.IsHaveSkin=function(t){return this.skinList.Contains(t)},t.prototype.SetSkin=function(t){this.currentSkin=t,this.Save()},t.prototype.RandomOppsiteSkin=function(){var t=Math.floor(7*Math.random()+1),e=this.currentSkin+t;return e>9?e-9:e},t._instance=null,t}();n.default=a,cc._RF.pop()},{"../Managers/NotificationCenter":"NotificationCenter","./List":"List"}],GameScene:[function(t,e,n){"use strict";cc._RF.push(e,"fc7e4vs46tPg7mzJDBi9MXh","GameScene");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/ConfigsManager"),r=t("./Player"),l=t("./BallController"),c=t("../Managers/NotificationCenter"),s=t("../EventDefine"),p=t("./NPCPlayer"),u=t("../Com/GameData"),h=t("./NPCKeeper"),f=t("../RefreshSceneObject"),d=cc._decorator,y=d.ccclass,v=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.starter=null,e.playerNodes=null,e.playerPrefab=null,e.npcplayerPrefab=null,e.npcKeeperPrefab=null,e.ballItem=null,e.avatarConfig=null,e.curGameNode=null,e.nexeGameNode=null,e.curLevel=1,e.yellowCloth=2,e.nexeLevelConfigs={},e.whitePlayerItems={},e.yellowPlayerItems={},e.npcKeeper=null,e.nextlevelWhitePlayers={},e.nextlevelYellowPlayers={},e}var n;return o(e,t),n=e,e.GetInstance=function(){return n._instance},e.prototype.onLoad=function(){n._instance=this;a.default.getInstance().loadAvatarConfig(this.avatarConfig),u.default.GetInstance().Init()},e.prototype.start=function(){var t=this;a.default.getInstance().loadConfigs(function(){t.starter.setCloth(u.default.GetInstance().currentSkin),t.loadPlayers()}),c.default.getInstance().on(s.OperateEvent.WhitePlayerGotNextLevel,this.onWhitePlayerGotoNext,this),c.default.getInstance().on(s.OperateEvent.YellowPlayerGotNextLevel,this.onYellowPlayerGotoNext,this),c.default.getInstance().on(s.OperateEvent.BallFallOnGround,this.onBallFallOnGround,this),c.default.getInstance().on(s.OperateEvent.GamePauseEvent,this.onGamePause,this),c.default.getInstance().on(s.OperateEvent.GameOverEvent,this.onGameOver,this),c.default.getInstance().on(s.OperateEvent.GotoNextLevel,this.gotoNextLevel,this),c.default.getInstance().on(s.OperateEvent.GameRestart,this.onGameRestart,this),c.default.getInstance().on(s.OperateEvent.GameContinue,this.onGameContinue,this)},e.prototype.onDestroy=function(){c.default.getInstance().off(s.OperateEvent.GameRestart,this.onGameRestart,this),c.default.getInstance().off(s.OperateEvent.GameContinue,this.onGameContinue,this),c.default.getInstance().off(s.OperateEvent.GotoNextLevel,this.gotoNextLevel,this),c.default.getInstance().off(s.OperateEvent.WhitePlayerGotNextLevel,this.onWhitePlayerGotoNext,this),c.default.getInstance().off(s.OperateEvent.YellowPlayerGotNextLevel,this.onYellowPlayerGotoNext,this),c.default.getInstance().off(s.OperateEvent.GamePauseEvent,this.onGamePause,this),c.default.getInstance().off(s.OperateEvent.GameOverEvent,this.onGameOver,this),c.default.getInstance().off(s.OperateEvent.BallFallOnGround,this.onBallFallOnGround,this)},e.prototype.changeCloth=function(t){this.starter.setCloth(t);for(var e=0;e<11;e++){var n=this.whitePlayerItems[e+1];null!=n&&n.setCloth(t)}},e.prototype.getLevelZDelta=function(t){return 42*(1-t)},e.prototype.onYellowPlayerGotoNext=function(t){if(this.yellowPlayerItems[t.playerNum]){this.nextlevelYellowPlayers[t.playerNum]=this.yellowPlayerItems[t.playerNum],delete this.yellowPlayerItems[t.playerNum],this.nextlevelYellowPlayers[t.playerNum].resetPlayer(this.nexeLevelConfigs.yellowCloth);var e=this.nexeLevelConfigs.yellow,n=a.default.getInstance().getPositionFromStr(e[t.playerNum]);this.nextlevelYellowPlayers[t.playerNum].node.position=n.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel+1)));var o=new cc.Quat;cc.Quat.fromEuler(o,0,0,0),this.nextlevelYellowPlayers[t.playerNum].node.setRotation(o)}if(this.ballItem.node.position.z-this.getLevelZDelta(this.curLevel)>2){var i=this.getLevelZDelta(this.curLevel+1);this.nexeGameNode.setPosition(new cc.Vec3(0,0,i)),this.nexeGameNode.getComponent(f.default).randomsetPosition(),console.log("-------------------"+this.curLevel+"-------==="+this.nexeGameNode.position.z)}},e.prototype.onWhitePlayerGotoNext=function(t){if(this.whitePlayerItems[t.playerNum]){this.nextlevelWhitePlayers[t.playerNum]=this.whitePlayerItems[t.playerNum],delete this.whitePlayerItems[t.playerNum],this.nextlevelWhitePlayers[t.playerNum].resetPlayer();var e=this.nexeLevelConfigs.white,n=a.default.getInstance().getPositionFromStr(e[t.playerNum]);this.nextlevelWhitePlayers[t.playerNum].node.position=n.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel+1)));var o=new cc.Quat;cc.Quat.fromEuler(o,0,0,0),this.nextlevelWhitePlayers[t.playerNum].node.setRotation(o)}},e.prototype.restartGame=function(){this.curLevel=1,this.curGameNode.position=cc.Vec3.ZERO,this.curGameNode.getComponent(f.default).randomsetPosition(),this.curGameNode.getComponent(f.default).revertPosition(),this.nexeGameNode.position=new cc.Vec3(0,0,-42),this.nexeGameNode.getComponent(f.default).randomsetPosition();var t=a.default.getInstance().getWhitePlayers(this.curLevel),e=a.default.getInstance().getYellowPlayers(this.curLevel);for(var n in this.yellowCloth=a.default.getInstance().getYellowCloth(this.curLevel),this.productNextLevelConfig(),this.whitePlayerItems){(c=this.whitePlayerItems[n]).resetPlayer();var o=a.default.getInstance().getPositionFromStr(t[c.playerNum]);c.node.position=o;var i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),c.node.setRotation(i)}for(var n in this.yellowPlayerItems){(l=this.yellowPlayerItems[n]).resetPlayer(this.yellowCloth);o=a.default.getInstance().getPositionFromStr(e[n]);l.node.position=o.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel)));i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),l.node.setRotation(i)}for(var r in this.nextlevelYellowPlayers){var l=this.nextlevelYellowPlayers[r];this.yellowPlayerItems[r]=l,l.resetPlayer(this.yellowCloth);o=a.default.getInstance().getPositionFromStr(e[r]);l.node.position=o;i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),l.node.setRotation(i)}for(var n in this.nextlevelYellowPlayers={},this.nextlevelWhitePlayers){var c=this.nextlevelWhitePlayers[n];this.whitePlayerItems[n]=c,c.resetPlayer();o=a.default.getInstance().getPositionFromStr(t[n]);c.node.position=o;i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),c.node.setRotation(i)}this.nextlevelWhitePlayers={},this.npcKeeper.restKeeper(this.yellowCloth),this.npcKeeper.node.position=a.default.getInstance().getPositionFromStr(e[11])},e.prototype.gotoNextLevel=function(t){console.log("-------------gotoNextLevel-------------");var e=this.curGameNode;for(var n in this.curGameNode=this.nexeGameNode,this.nexeGameNode=e,this.curGameNode.getComponent(f.default).revertPosition(),this.curLevel=this.curLevel+1,this.whitePlayerItems){var o=this.whitePlayerItems[n];if(o.state!=s.PlayerState.FollowBall){o.resetPlayer();var i=this.nexeLevelConfigs.white,r=a.default.getInstance().getPositionFromStr(i[o.playerNum]);o.node.position=r.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel)));var l=new cc.Quat;cc.Quat.fromEuler(l,0,0,0),o.node.setRotation(l)}}for(var c in this.nextlevelWhitePlayers)this.whitePlayerItems[c]=this.nextlevelWhitePlayers[c];for(var n in this.nextlevelWhitePlayers={},this.yellowPlayerItems){var p=this.yellowPlayerItems[n];p.resetPlayer(this.nexeLevelConfigs.yellowCloth);var u=this.nexeLevelConfigs.yellow;r=a.default.getInstance().getPositionFromStr(u[p.playerNum]);p.node.position=r.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel)));l=new cc.Quat;cc.Quat.fromEuler(l,0,0,0),p.node.setRotation(l)}for(var c in this.nextlevelYellowPlayers)this.yellowPlayerItems[c]=this.nextlevelYellowPlayers[c];this.nextlevelYellowPlayers={};r=a.default.getInstance().getPositionFromStr(this.nexeLevelConfigs.yellow[11]);this.npcKeeper.restKeeper(this.nexeLevelConfigs.yellowCloth),this.npcKeeper.node.position=r.add(new cc.Vec3(0,0,this.getLevelZDelta(this.curLevel))),this.productNextLevelConfig()},e.prototype.productNextLevelConfig=function(){var t=a.default.getInstance().getWhitePlayers(2),e=a.default.getInstance().getYellowPlayers(2),n=a.default.getInstance().getYellowCloth(2);this.nexeLevelConfigs={white:t,yellow:e,yellowCloth:n}},e.prototype.onGameOver=function(){for(var t in this.whitePlayerItems){this.whitePlayerItems[t].onGameOver()}for(var t in this.yellowPlayerItems){this.yellowPlayerItems[t].onGameOver()}this.npcKeeper.onGameOver()},e.prototype.onGameContinue=function(){for(var t in this.whitePlayerItems){this.whitePlayerItems[t].onGameContinue()}for(var t in this.yellowPlayerItems){this.yellowPlayerItems[t].onGameContinue()}this.npcKeeper.onGameContinue()},e.prototype.onGameRestart=function(){this.restartGame()},e.prototype.onGamePause=function(){for(var t in this.whitePlayerItems){this.whitePlayerItems[t].onGamePause()}for(var t in this.yellowPlayerItems){this.yellowPlayerItems[t].onGamePause()}this.npcKeeper.onGamePause()},e.prototype.loadPlayers=function(){var t=a.default.getInstance().getWhitePlayers(this.curLevel),e=a.default.getInstance().getYellowPlayers(this.curLevel);for(var n in this.yellowCloth=a.default.getInstance().getYellowCloth(this.curLevel),this.productNextLevelConfig(),t){var o=a.default.getInstance().getPositionFromStr(t[n]);(s=cc.instantiate(this.playerPrefab)).parent=this.node.parent,s.position=o;var i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),s.setRotation(i);var l=s.getComponent(r.default);l.loadData(n,u.default.GetInstance().currentSkin,!0),l.ballNode=this.ballItem.node,this.whitePlayerItems[parseInt(n)]=l}for(var c in e)if(11==parseInt(c)){o=a.default.getInstance().getPositionFromStr(e[c]);(s=cc.instantiate(this.npcKeeperPrefab)).parent=this.node.parent,s.position=o;i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),s.setRotation(i),this.npcKeeper=s.getComponent(h.default),this.npcKeeper.loadData(c,this.yellowCloth,!1),this.npcKeeper.ballNode=this.ballItem.node}else{var s;o=a.default.getInstance().getPositionFromStr(e[c]);(s=cc.instantiate(this.npcplayerPrefab)).parent=this.node.parent,s.position=o;i=new cc.Quat;cc.Quat.fromEuler(i,0,0,0),s.setRotation(i);var f=s.getComponent(p.default);f.loadData(c,this.yellowCloth,!1),f.ballNode=this.ballItem.node,this.yellowPlayerItems[parseInt(c)]=f}},e.prototype.onBallFallOnGround=function(t){var e=0,n=1e3;for(var o in this.whitePlayerItems){if((a=this.whitePlayerItems[o]).state==s.PlayerState.Idle||a.state==s.PlayerState.RunBackForBall||a.state==s.PlayerState.RunBackForPlayer){var i=cc.Vec3.distance(a.node.position,this.ballItem.node.position);i<n&&i<8&&(e=parseInt(o),n=i)}}if(0!=e)for(var o in this.whitePlayerItems[e].startFllowBall(this.ballItem.node.position),this.whitePlayerItems){var a;if(e!=parseInt(o))(a=this.whitePlayerItems[o]).state===s.PlayerState.RunBackForBall&&a.turnDsiable()}},e.prototype.update=function(){if(0!=this.ballItem.canGameUpdate())if(this.ballItem.state===s.BallState.Flying){for(var t in this.whitePlayerItems){var e=this.whitePlayerItems[t];this.ballItem.node.position.z<e.node.position.z&&e.startRunBackAfterBall()}if(this.ballItem.touchdown)for(var t in this.whitePlayerItems){if((e=this.whitePlayerItems[t]).checkBallIsNear(this.ballItem.node.position)<.8){e.turnFollowBall();break}}}else if(this.ballItem.state===s.BallState.Lining){for(var t in this.onBallFallOnGround(null),this.whitePlayerItems){if((e=this.whitePlayerItems[t]).state===s.PlayerState.Follow)if(e.checkFollowSpeed(this.ballItem.touchdown),this.ballItem.touchdown)if(e.checkBallIsNear(this.ballItem.node.position)<.8){e.turnFollowBall();break}}for(var t in this.yellowPlayerItems){if((n=this.yellowPlayerItems[t]).state==s.NPCState.Idle)n.canShiftBall=!1,cc.Vec3.distance(n.node.position,this.ballItem.node.position)<3&&n.startFllowBall(this.ballItem.node.position)}}else if(this.ballItem.state===s.BallState.Follow){for(var t in this.whitePlayerItems){(e=this.whitePlayerItems[t]).state===s.PlayerState.Idle&&this.ballItem.curFollowPlayer.node.position.z-e.node.position.z<4&&e.startRuning()}for(var t in this.yellowPlayerItems){var n;if((n=this.yellowPlayerItems[t]).state==s.NPCState.Idle)cc.Vec3.distance(n.node.position,this.ballItem.node.position)<3&&n.startFllowBall(this.ballItem.node.position);else n.state==s.NPCState.FollowBall&&(n.canShiftBall=!0)}}},i([v(r.default)],e.prototype,"starter"),i([v(cc.Node)],e.prototype,"playerNodes"),i([v(cc.Prefab)],e.prototype,"playerPrefab"),i([v(cc.Prefab)],e.prototype,"npcplayerPrefab"),i([v(cc.Prefab)],e.prototype,"npcKeeperPrefab"),i([v(l.default)],e.prototype,"ballItem"),i([v(cc.JsonAsset)],e.prototype,"avatarConfig"),i([v(cc.Node)],e.prototype,"curGameNode"),i([v(cc.Node)],e.prototype,"nexeGameNode"),e=n=i([y],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../Com/GameData":"GameData","../EventDefine":"EventDefine","../Managers/ConfigsManager":"ConfigsManager","../Managers/NotificationCenter":"NotificationCenter","../RefreshSceneObject":"RefreshSceneObject","./BallController":"BallController","./NPCKeeper":"NPCKeeper","./NPCPlayer":"NPCPlayer","./Player":"Player"}],GameUIController:[function(t,e,n){"use strict";cc._RF.push(e,"311denD3KdCbbniDxtNdSdj","GameUIController");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../EventDefine"),r=t("../SceneLogic/BallController"),l=cc._decorator,c=l.ccclass,s=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerTouchNode=null,e.startUI=null,e.settingUI=null,e.gameUI=null,e.startInstance=null,e.settingInstance=null,e.gameInstance=null,e.ballController=null,e}var n;return o(e,t),n=e,e.Instance=function(){return n.instance},e.prototype.onLoad=function(){n.instance=this},e.prototype.start=function(){var t=this;this.startInstance=cc.instantiate(this.startUI),this.node.addChild(this.startInstance),this.playerTouchNode.on(cc.Node.EventType.TOUCH_START,this.onMouseDown,this),this.playerTouchNode.on(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this),this.playerTouchNode.on(cc.Node.EventType.TOUCH_END,this.onMouseUp,this),this.playerTouchNode.on(cc.Node.EventType.TOUCH_CANCEL,this.onMouseUp,this),this.node.on(a.UIEvents.StartUIClickStartEvent,function(){t.openUI(a.UIType.Game,!1)},this),this.node.on(a.UIEvents.StartUIClickSettingEvent,function(){t.openUI(a.UIType.Setting,!0)},this)},e.prototype.onDestroy=function(){this.playerTouchNode.off(cc.Node.EventType.TOUCH_START,this.onMouseDown,this),this.playerTouchNode.off(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this),this.playerTouchNode.off(cc.Node.EventType.TOUCH_END,this.onMouseUp,this),this.playerTouchNode.off(cc.Node.EventType.TOUCH_CANCEL,this.onMouseUp,this)},e.prototype.openUI=function(t,e){switch(e||(null!=this.startInstance&&(this.startInstance.active=!1),null!=this.settingInstance&&(this.settingInstance.active=!1),null!=this.gameInstance&&(this.gameInstance.active=!1)),t){case a.UIType.Start:null==this.startInstance&&(this.startInstance=cc.instantiate(this.startUI),this.node.addChild(this.startInstance)),this.startInstance.active=!0;break;case a.UIType.Setting:null==this.settingInstance&&(this.settingInstance=cc.instantiate(this.settingUI),this.node.addChild(this.settingInstance)),this.settingInstance.active=!0;break;case a.UIType.Game:null==this.gameInstance&&(this.gameInstance=cc.instantiate(this.gameUI),this.node.addChild(this.gameInstance)),this.gameInstance.active=!0}},e.prototype.onMouseDown=function(t){this.ballController.onMouseDown(t)},e.prototype.onMouseMove=function(t){this.ballController.onMouseMove(t)},e.prototype.onMouseUp=function(t){this.ballController.onMouseUp(t)},e.instance=null,i([s(cc.Node)],e.prototype,"playerTouchNode"),i([s(cc.Prefab)],e.prototype,"startUI"),i([s(cc.Prefab)],e.prototype,"settingUI"),i([s(cc.Prefab)],e.prototype,"gameUI"),i([s(r.default)],e.prototype,"ballController"),e=n=i([c],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../EventDefine":"EventDefine","../SceneLogic/BallController":"BallController"}],GameUI:[function(t,e,n){"use strict";cc._RF.push(e,"e2297hPK3JGJYy9FQpjKpTK","GameUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=t("./GamingUI"),c=t("./EndUI"),s=cc._decorator,p=s.ccclass,u=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tapStartUI=null,e.gameingUI=null,e.tapButton=null,e.pauseUI=null,e.endUI=null,e.pauseInstance=null,e.endInstance=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;cc.find("GamingUI/SettingBtn",this.node).on("click",function(e){null==t.pauseInstance&&(t.pauseInstance=cc.instantiate(t.pauseUI),t.node.addChild(t.pauseInstance)),t.pauseInstance.active=!0,a.default.getInstance().emit(r.OperateEvent.GamePauseEvent,null)})},e.prototype.start=function(){var t=this;a.default.getInstance().on(r.OperateEvent.GameOverScoreEvent,this.onGameOver,this),this.tapButton.node.on("click",this.onTapStartClick,this),this.tapStartUI.active=!0,this.gameingUI.node.active=!1,this.node.on(r.UIEvents.StartUIClickStartEvent,function(){t.tapStartUI.active=!0},this)},e.prototype.onDestroy=function(){a.default.getInstance().off(r.OperateEvent.GameOverScoreEvent,this.onGameOver,this)},e.prototype.onGameOver=function(t){null==this.endInstance&&(this.endInstance=cc.instantiate(this.endUI),this.node.addChild(this.endInstance)),this.endInstance.active=!0,this.endInstance.getComponent(c.default).onGameOver(t)},e.prototype.onTapStartClick=function(){this.tapStartUI.active=!1,this.gameingUI.node.active=!0,a.default.getInstance().emit(r.OperateEvent.TapStartGame,null)},e.prototype.updateCirclePos=function(t){this.gameingUI.updateCirclePos(t)},i([u(cc.Node)],e.prototype,"tapStartUI"),i([u(l.default)],e.prototype,"gameingUI"),i([u(cc.Button)],e.prototype,"tapButton"),i([u(cc.Prefab)],e.prototype,"pauseUI"),i([u(cc.Prefab)],e.prototype,"endUI"),e=i([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./EndUI":"EndUI","./GamingUI":"GamingUI"}],GamingUI:[function(t,e,n){"use strict";cc._RF.push(e,"4057984m6RH+69y3QGla3T9","GamingUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=t("../Managers/SettingManager"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.circle=null,e.trailNode=null,e.goalNode=null,e.scoreLabel=null,e.bestScoreLabel=null,e.trailAnimation=null,e.levelScore=0,e}return o(e,t),e.prototype.start=function(){this.circle.active=!1,this.trailNode.active=!1,this.goalNode.active=!1,this.scoreLabel.string="0",this.bestScoreLabel.string=l.default.getInstance().bestScore.toString(),a.default.getInstance().on(r.OperateEvent.GameRestart,this.onGameRestart,this),a.default.getInstance().on(r.OperateEvent.GameOverEvent,this.onGameOver,this),a.default.getInstance().on(r.OperateEvent.GotoNextLevel,this.onGotoNextLevel,this),a.default.getInstance().on(r.OperateEvent.BallFallOnGround,this.onBallFallGround,this),a.default.getInstance().on(r.OperateEvent.BallIsFlying,this.onBallIsFlying,this),a.default.getInstance().on(r.OperateEvent.BallStartFly,this.onBallStartFly,this),a.default.getInstance().on(r.OperateEvent.BallStartFall,this.onBallStartFall,this),a.default.getInstance().on(r.OperateEvent.GameScoreChanging,this.onScoreChanging,this)},e.prototype.onDestroy=function(){a.default.getInstance().off(r.OperateEvent.GameRestart,this.onGameRestart,this),a.default.getInstance().off(r.OperateEvent.GameOverEvent,this.onGameOver,this),a.default.getInstance().off(r.OperateEvent.GameScoreChanging,this.onScoreChanging,this),a.default.getInstance().off(r.OperateEvent.GotoNextLevel,this.onGotoNextLevel,this),a.default.getInstance().off(r.OperateEvent.BallFallOnGround,this.onBallFallGround,this),a.default.getInstance().off(r.OperateEvent.BallIsFlying,this.onBallIsFlying,this),a.default.getInstance().off(r.OperateEvent.BallStartFall,this.onBallStartFall,this),a.default.getInstance().off(r.OperateEvent.BallStartFly,this.onBallStartFly,this)},e.prototype.onGameOver=function(t){l.default.getInstance().setBestScore(parseInt(this.scoreLabel.string)),this.bestScoreLabel.string=l.default.getInstance().bestScore.toString(),a.default.getInstance().emit(r.OperateEvent.GameOverScoreEvent,{score:this.scoreLabel.string})},e.prototype.onGameRestart=function(t){this.scoreLabel.string="0"},e.prototype.onScoreChanging=function(t){var e=18.8-t.z,n=Math.round(3*e);n+=this.levelScore,this.scoreLabel.string=n.toString()},e.prototype.onBallIsFlying=function(t){null!=t&&(this.trailNode.position=this.updateCirclePos(t)),this.trailNode.active=!1},e.prototype.onBallStartFly=function(t){null!=t&&(null!=t.direction||(this.trailNode.active=!1)),this.circle.active=!1},e.prototype.onBallStartFall=function(t){null!=t&&(this.circle.position=this.updateCirclePos(t)),this.circle.active=!0},e.prototype.onBallFallGround=function(t){},e.prototype.updateCirclePos=function(t){var e=cc.Camera.findCamera(this.node),n=cc.Vec3.ZERO;e.getScreenToWorldPoint(t,n);var o=cc.Vec3.ZERO;return this.node.convertToNodeSpaceAR(n,o),o},e.prototype.onGotoNextLevel=function(t){this.levelScore+=50,this.goalNode.active=!0;var e=this;this.scheduleOnce(function(){e.goalNode.active=!1},2)},i([p(cc.Node)],e.prototype,"circle"),i([p(cc.Node)],e.prototype,"trailNode"),i([p(cc.Node)],e.prototype,"goalNode"),i([p(cc.Label)],e.prototype,"scoreLabel"),i([p(cc.Label)],e.prototype,"bestScoreLabel"),i([p(cc.Animation)],e.prototype,"trailAnimation"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","../Managers/SettingManager":"SettingManager"}],List:[function(t,e,n){"use strict";cc._RF.push(e,"74037Qx35FFaLwRNr2apsA+","List"),n.__esModule=!0;var o=function(){function t(t){null!=t?(this.cursor=t.length,this.length=t.length,this.content=t):(this.cursor=0,this.length=0,this.content=new Array)}return t.prototype.InitFromJSON=function(t){if(null!=t){this.cursor=t.content.length,this.length=t.content.length;for(var e=0;e<t.length;e++){var n=t.content[e];this.RawSet(e,n)}}else console.warn("can not init List from null")},t.prototype.RawSet=function(t,e){this.content[t]=e},t.prototype.Add=function(t){this.content[this.cursor]=t,this.cursor++,this.length++},t.prototype.Clear=function(){this.cursor=0,this.length=0,this.content=new Array},t.prototype.Remove=function(t){for(var e=-1,n=0;n<this.content.length;n++){if(this.content[n]==t){e=n;break}}if(e>=0){for(n=e;n<this.content.length-1;n++)this.content[n]=this.content[n+1];this.length--}},t.prototype.Contains=function(t){for(var e=0;e<this.content.length;e++){if(this.content[e]==t)return!0}return!1},t.prototype.GetByIndex=function(t){return this.content[t]},t.prototype.toString=function(){for(var t="len:"+this.length+"--",e=0;e<this.length;e++)t+=this.GetByIndex(e)+",";return t},t}();n.default=o,cc._RF.pop()},{}],NPCCollider:[function(t,e,n){"use strict";cc._RF.push(e,"23967U/cMNN34s1v2Zwlexq","NPCCollider");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=t("./NPCPlayer"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collider1=null,e.collider2=null,e}return o(e,t),e.prototype.start=function(){this.collider1.on("collision-enter",this.onCollision,this),this.collider2.on("collision-enter",this.onCollision,this)},e.prototype.onDestroy=function(){this.collider1.off("collision-enter",this.onCollision,this),this.collider2.off("collision-enter",this.onCollision,this)},e.prototype.onCollision=function(t){if("BallNode"==t.otherCollider.node.name){var e=this.node.getComponent(l.default);a.default.getInstance().emit(r.OperateEvent.YellowPlayerGetBall,e)}},i([p(cc.BoxCollider3D)],e.prototype,"collider1"),i([p(cc.BoxCollider3D)],e.prototype,"collider2"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./NPCPlayer":"NPCPlayer"}],NPCKeeper:[function(t,e,n){"use strict";cc._RF.push(e,"3cf84yjrG5EdopeC11I1RZy","NPCKeeper");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/NotificationCenter"),r=t("../EventDefine"),l=t("./PlayerAnimation"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerRender=null,e.numRender=null,e.keeperCllider=null,e.ballNode=null,e.gameOver=!1,e.gamePause=!1,e.state=r.NPCKeeperState.Idle,e.playerAnimation=null,e.movedirection=new cc.Vec3(1,0,0),e}return o(e,t),e.prototype.start=function(){this.playerAnimation=this.node.getComponent(l.default),this.keeperCllider.on("collision-enter",this.onCollision,this)},e.prototype.onDestroy=function(){this.keeperCllider.off("collision-enter",this.onCollision,this)},e.prototype.restKeeper=function(t){this.gameOver=!1,this.gamePause=!1,this.state=r.NPCKeeperState.Idle,this.movedirection=new cc.Vec3(1,0,0),this.playerAnimation.playIdle();var e=this;cc.loader.loadRes("Materials/Players/PlayerCloth"+t.toString(),cc.Material,function(t,n){null==t&&e.playerRender.getComponent(cc.RenderComponent).setMaterial(0,n)})},e.prototype.onCollision=function(t){"BallNode"==t.otherCollider.node.name&&a.default.getInstance().emit(r.OperateEvent.YellowPlayerGetBall,this)},e.prototype.turnReset=function(){this.state=r.NPCKeeperState.Idle,this.playerAnimation.playIdle()},e.prototype.onGameOver=function(){this.gameOver=!0,this.state=r.NPCKeeperState.Idle,this.playerAnimation.playIdle()},e.prototype.onGamePause=function(){this.gamePause=!0},e.prototype.onGameContinue=function(){this.gamePause=!1},e.prototype.loadData=function(t,e,n){var o=this;!0===n?cc.loader.loadRes("Materials/PlayerNums/white/White"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}):cc.loader.loadRes("Materials/PlayerNums/yellow/Yellow"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}),cc.loader.loadRes("Materials/Players/PlayerCloth"+e.toString(),cc.Material,function(t,e){null==t&&o.playerRender.getComponent(cc.RenderComponent).setMaterial(0,e)})},e.prototype.update=function(t){if(!this.gameOver&&!this.gamePause)if(this.state==r.NPCKeeperState.Defense)cc.Vec3.distance(this.node.position,this.ballNode.position)<4&&(this.state=r.NPCKeeperState.FetchBall,(e=this.ballNode.position.sub(this.node.position)).y=0,cc.Vec3.normalize(this.movedirection,e),this.movedirection.z*=.1,this.ballNode.position.x>this.node.position.x?this.playerAnimation.playShiftRight():this.playerAnimation.playShiftLeft());else if(this.state==r.NPCKeeperState.Idle){cc.Vec3.distance(this.node.position,this.ballNode.position)<10&&(this.state=r.NPCKeeperState.Defense,this.movedirection=new cc.Vec3(1,0,0),this.playerAnimation.playDefense())}else if(this.state==r.NPCKeeperState.FetchBall){var e;(e=this.ballNode.position.sub(this.node.position)).y=0,cc.Vec3.normalize(this.movedirection,e),this.movedirection.z*=.1;var n=10/cc.Vec3.distance(e,this.node.position),o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,this.movedirection,t*n),this.node.position=this.node.position.add(o)}},i([p(cc.Node)],e.prototype,"playerRender"),i([p(cc.Node)],e.prototype,"numRender"),i([p(cc.BoxCollider3D)],e.prototype,"keeperCllider"),i([p(cc.Node)],e.prototype,"ballNode"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./PlayerAnimation":"PlayerAnimation"}],NPCPlayer:[function(t,e,n){"use strict";cc._RF.push(e,"d288aKod3BG2KKbe3fLCnSX","NPCPlayer");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../EventDefine"),r=t("./PlayerAnimation"),l=t("../Managers/NotificationCenter"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerRender=null,e.numRender=null,e.ballNode=null,e.state=a.NPCState.Idle,e.playerAnimation=null,e.moveDirection=cc.Vec3.ZERO,e.followSpeed=1.8,e.shiftSpeed=4,e.canShiftBall=!1,e.gameOver=!1,e.gamePause=!1,e.playerNum=0,e}return o(e,t),e.prototype.start=function(){this.playerAnimation=this.node.getComponent(r.default)},e.prototype.resetPlayer=function(t){this.state=a.NPCState.Idle,this.moveDirection=cc.Vec3.ZERO,this.followSpeed=1.3,this.shiftSpeed=4,this.canShiftBall=!1,this.gameOver=!1,this.gamePause=!1;var e=this;this.playerAnimation.playIdle(),cc.loader.loadRes("Materials/Players/PlayerCloth"+t.toString(),cc.Material,function(t,n){null==t&&e.playerRender.getComponent(cc.RenderComponent).setMaterial(0,n)})},e.prototype.loadData=function(t,e,n){this.playerNum=t;var o=this;!0===n?cc.loader.loadRes("Materials/PlayerNums/white/White"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}):cc.loader.loadRes("Materials/PlayerNums/yellow/Yellow"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}),cc.loader.loadRes("Materials/Players/PlayerCloth"+e.toString(),cc.Material,function(t,e){null==t&&o.playerRender.getComponent(cc.RenderComponent).setMaterial(0,e)})},e.prototype.turnDsiable=function(){this.state!=a.NPCState.Disabled&&(this.playerAnimation.playIdle(),this.state=a.NPCState.Disabled)},e.prototype.turnReset=function(){this.playerAnimation.playIdleReset(),this.state=a.NPCState.Disabled},e.prototype.startFllowBall=function(t){var e=new cc.Vec3(t.x,0,t.z);cc.Vec3.distance(e,this.node.position)>3?this.turnDsiable():(this.moveDirection=this.checkRotate(e),this.state===a.NPCState.Idle&&this.playerAnimation.playRun(),this.state=a.NPCState.FollowBall)},e.prototype.checkRotate=function(t){var e=this.node.position.subtract(t),n=cc.Vec3.ZERO;cc.Vec3.normalize(n,e),n.x=-n.x,n.z=-n.z;var o=new cc.Vec2(n.x,n.z),i=new cc.Vec2(1,0),a=o.signAngle(i),r=Math.floor(cc.misc.radiansToDegrees(a)),l=new cc.Quat;return cc.Quat.fromEuler(l,0,90+r,0),this.node.setRotation(l),n},e.prototype.onGameOver=function(){this.gameOver=!0,this.state!=a.NPCState.ShiftBall&&this.turnDsiable()},e.prototype.onGamePause=function(){this.gamePause=!0},e.prototype.onGameContinue=function(){this.gamePause=!1},e.prototype.update=function(t){if(!this.gameOver&&!this.gamePause)if(this.state===a.NPCState.FollowBall){this.startFllowBall(this.ballNode.position),this.playerAnimation.checkPlayRun();var e=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(e,this.moveDirection,this.followSpeed*t),this.node.setPosition(this.node.position.add(e));var n=new cc.Vec3(this.ballNode.position.x,0,this.ballNode.position.z);if((i=cc.Vec3.distance(n,this.node.position))<.6){if(this.canShiftBall){var o=this;this.state=a.NPCState.ShiftBall,this.playerAnimation.playShiftBall(function(){o.turnDsiable()})}}else i>3&&this.turnDsiable()}else if(this.state===a.NPCState.Disabled){var i;n=new cc.Vec3(this.ballNode.position.x,0,this.ballNode.position.z);(i=cc.Vec3.distance(n,this.node.position))>4&&(this.state=a.NPCState.Idle,l.default.getInstance().emit(a.OperateEvent.YellowPlayerGotNextLevel,this))}},i([p(cc.Node)],e.prototype,"playerRender"),i([p(cc.Node)],e.prototype,"numRender"),i([p(cc.Node)],e.prototype,"ballNode"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./PlayerAnimation":"PlayerAnimation"}],NewSkinUI:[function(t,e,n){"use strict";cc._RF.push(e,"de83cHb+2BHkoFduDBc+vRE","NewSkinUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/ConfigsManager"),r=cc._decorator,l=r.ccclass,c=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atlas=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;cc.find("bg/ok",this.node).on("click",function(e){t.node.destroy()})},e.prototype.setCloth=function(t){var e=a.default.getInstance().avatarConfig.GetByIndex(t-1);cc.find("bg/icon",this.node).getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(e.icon)},i([c(cc.SpriteAtlas)],e.prototype,"atlas"),e=i([l],e)}(cc.Component);n.default=s,cc._RF.pop()},{"../Managers/ConfigsManager":"ConfigsManager"}],NotificationCenter:[function(t,e,n){"use strict";cc._RF.push(e,"1357elqFDtPq6/mE3aUUZDu","NotificationCenter");var o=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var i=cc._decorator,a=i.ccclass,r=(i.property,function(){function t(){this.handles_={}}var e;return e=t,t.getInstance=function(){return e.instance||(e.instance=new e),e.instance},t.prototype.emit=function(t,e){var n=[];e=e||{};var o=t;for(var i in e.eventName=o,this.handles_)if(i==t)for(var a=0;a<this.handles_[o].length;a++){var r=this.handles_[o][a],l=r.callback.call(r.target,e);n.push(l)}return n},t.prototype.on=function(t,e,n){0==Array.isArray(t)&&(t=[t]);for(var o=0,i=t.length;o<i;o++){var a=t[o];this.handles_[a]=this.handles_[a]||[],this.handles_[a].push({callback:e,target:n})}},t.prototype.off=function(t,e,n){for(var o in void 0==n&&(n=e,e=void 0),0==Array.isArray(t)&&(t=[t]),t)for(var i=t[o],a=0;a<this.handles_[i].length;a++){var r=this.handles_[i][a];n!=r.target||e.toString()!=r.callback.toString()&&void 0!=e||this.handles_[i].splice(a,1)}},t=e=o([a],t)}());n.default=r,cc._RF.pop()},{}],PauseUI:[function(t,e,n){"use strict";cc._RF.push(e,"62b83BL3EJNCIe/mglQScnb","PauseUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../EventDefine"),r=t("../Managers/NotificationCenter"),l=t("./GameUIController"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){var t=this;cc.find("go",this.node).on("click",function(e){t.node.active=!1,r.default.getInstance().emit(a.OperateEvent.GameContinue,null)}),cc.find("title/close",this.node).on("click",function(e){t.node.active=!1}),cc.find("home",this.node).on("click",function(e){t.node.active=!1,r.default.getInstance().emit(a.OperateEvent.GameRestart,null);var n=new cc.Event.EventCustom(a.UIEvents.StartUIClickStartEvent,!0);t.node.dispatchEvent(n),l.default.Instance().openUI(a.UIType.Start,!1)})},e=i([s],e)}(cc.Component));n.default=p,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./GameUIController":"GameUIController"}],PlayerAnimation:[function(t,e,n){"use strict";cc._RF.push(e,"ebf80vqKrhBoLAG+jb8oV+U","PlayerAnimation");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=cc._decorator,r=a.ccclass,l=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Idle=null,e.Idle_Reset=null,e.Fall=null,e.Defence=null,e.KickOff=null,e.LeftShift=null,e.PassBall=null,e.RightShift=null,e.Run=null,e.Tackl=null,e.playerAnimation=null,e.shiftBallinvoke=null,e}return o(e,t),e.prototype.start=function(){this.Idle.name="Idle",this.Idle_Reset.name="Idle_Reset",this.Fall.name="Fall",this.Defence.name="Defence",this.KickOff.name="KickOff",this.LeftShift.name="LeftShift",this.PassBall.name="PassBall",this.RightShift.name="RightShift",this.Run.name="Run",this.Tackl.name="Tackl",this.playerAnimation.addClip(this.Idle),this.playerAnimation.addClip(this.Idle_Reset),this.playerAnimation.addClip(this.Fall),this.playerAnimation.addClip(this.Defence),this.playerAnimation.addClip(this.KickOff),this.playerAnimation.addClip(this.LeftShift),this.playerAnimation.addClip(this.PassBall),this.playerAnimation.addClip(this.RightShift),this.playerAnimation.addClip(this.Run),this.playerAnimation.addClip(this.Tackl),this.playerAnimation.defaultClip=this.Idle,this.playerAnimation.play()},e.prototype.playIdle=function(){this.playerAnimation.defaultClip=this.Idle,this.playerAnimation.play()},e.prototype.playIdleReset=function(){this.playerAnimation.defaultClip=this.Idle_Reset,this.playerAnimation.play()},e.prototype.playRun=function(t){void 0===t&&(t=1),this.playerAnimation.defaultClip=this.Run,this.Run.speed=t,this.playerAnimation.play()},e.prototype.playKickBall=function(){this.playerAnimation.defaultClip=this.PassBall,this.PassBall.wrapMode=cc.WrapMode.Normal,this.playerAnimation.play(),this.playerAnimation.on(cc.Animation.EventType.FINISHED,this.onKickOffFinished,this)},e.prototype.onKickOffFinished=function(){this.playerAnimation.off(cc.Animation.EventType.FINISHED,this.onKickOffFinished,this)},e.prototype.checkPlayRun=function(){this.playerAnimation.defaultClip!=this.Run&&(this.playerAnimation.defaultClip=this.Run,this.playerAnimation.play())},e.prototype.playShiftBall=function(t){this.Tackl.wrapMode=cc.WrapMode.Normal,this.playerAnimation.defaultClip=this.Tackl,this.shiftBallinvoke=t,this.playerAnimation.play(),this.playerAnimation.on(cc.Animation.EventType.FINISHED,this.onShiftBallEnd,this)},e.prototype.onShiftBallEnd=function(){this.playerAnimation.off(cc.Animation.EventType.FINISHED,this.onShiftBallEnd,this),this.shiftBallinvoke&&(this.shiftBallinvoke(),this.shiftBallinvoke=null),this.playIdle()},e.prototype.playFall=function(t){console.log("----------------play fall--------------"),this.Fall.wrapMode=cc.WrapMode.Normal,this.playerAnimation.defaultClip=this.Fall,this.playerAnimation.play(),setTimeout(function(){t()},1e3*this.Fall.duration)},e.prototype.playShiftRight=function(){this.RightShift.wrapMode=cc.WrapMode.Loop,this.playerAnimation.defaultClip=this.RightShift,this.playerAnimation.play()},e.prototype.playShiftLeft=function(){this.LeftShift.wrapMode=cc.WrapMode.Loop,this.playerAnimation.defaultClip=this.LeftShift,this.playerAnimation.play()},e.prototype.playDefense=function(){this.Defence.wrapMode=cc.WrapMode.Normal,this.playerAnimation.defaultClip=this.Defence,this.playerAnimation.play()},i([l(cc.SkeletonAnimationClip)],e.prototype,"Idle"),i([l(cc.SkeletonAnimationClip)],e.prototype,"Idle_Reset"),i([l(cc.SkeletonAnimationClip)],e.prototype,"Fall"),i([l(cc.SkeletonAnimationClip)],e.prototype,"Defence"),i([l(cc.SkeletonAnimationClip)],e.prototype,"KickOff"),i([l(cc.SkeletonAnimationClip)],e.prototype,"LeftShift"),i([l(cc.SkeletonAnimationClip)],e.prototype,"PassBall"),i([l(cc.SkeletonAnimationClip)],e.prototype,"RightShift"),i([l(cc.SkeletonAnimationClip)],e.prototype,"Run"),i([l(cc.SkeletonAnimationClip)],e.prototype,"Tackl"),i([l(cc.SkeletonAnimation)],e.prototype,"playerAnimation"),e=i([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"693e5RoVtVCWb7TMjnjvTcf","Player");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("./PlayerAnimation"),r=t("../EventDefine"),l=t("../Managers/NotificationCenter"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerRender=null,e.numRender=null,e.ballNode=null,e.t1=null,e.t2=null,e.t3=null,e.t4=null,e.t5=null,e.t6=null,e.t7=null,e.t8=null,e.t9=null,e.playerAnimation=null,e.startfollowSpeed=2,e.followfriction=0,e.movedirection=cc.Vec3.ZERO,e.state=r.PlayerState.Idle,e.followBallSpeed=1,e.followBallFriction=0,e.gameOver=!1,e.gamePause=!1,e.playerNum=0,e}return o(e,t),e.prototype.start=function(){this.playerAnimation=this.node.getComponent(a.default),l.default.getInstance().on(r.OperateEvent.PlayerFollowBall,this.onSomePlayerFollowBall,this)},e.prototype.onDestroy=function(){l.default.getInstance().off(r.OperateEvent.PlayerFollowBall,this.onSomePlayerFollowBall,this)},e.prototype.resetPlayer=function(){this.startfollowSpeed=2,this.followfriction=0,this.movedirection=cc.Vec3.ZERO,this.state=r.PlayerState.Idle,this.followBallSpeed=1,this.followBallFriction=0,this.gameOver=!1,this.gamePause=!1,this.playerAnimation.playIdle()},e.prototype.onSomePlayerFollowBall=function(){this.state!==r.PlayerState.FollowBall&&(this.state===r.PlayerState.Follow?(this.state=r.PlayerState.Idle,this.playerAnimation.playIdle()):this.state===r.PlayerState.RunBackForBall&&(this.state=r.PlayerState.Disabled,this.playerAnimation.playIdle()))},e.prototype.loadData=function(t,e,n){console.log("load player "+t+","+e+","+n);var o=this;this.playerNum=t,!0===n?cc.loader.loadRes("Materials/PlayerNums/white/White"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}):cc.loader.loadRes("Materials/PlayerNums/yellow/Yellow"+t.toString(),cc.Material,function(t,e){null==t&&o.numRender.getComponent(cc.RenderComponent).setMaterial(0,e)}),this.setCloth(e)},e.prototype.setCloth=function(t){var e=this.playerRender.getComponent(cc.RenderComponent);switch(console.log(""+this.t1.name),t){case 1:e.setMaterial(0,this.t1);break;case 2:e.setMaterial(0,this.t2);break;case 3:e.setMaterial(0,this.t3);break;case 4:e.setMaterial(0,this.t4);break;case 5:e.setMaterial(0,this.t5);break;case 6:e.setMaterial(0,this.t6);break;case 7:e.setMaterial(0,this.t7);break;case 8:e.setMaterial(0,this.t8);break;case 9:e.setMaterial(0,this.t9)}},e.prototype.fallGround=function(t){this.state=r.PlayerState.Disabled,this.playerAnimation.playFall(t)},e.prototype.turnDsiable=function(){this.state!=r.PlayerState.Disabled&&(this.playerAnimation.playIdle(),this.state=r.PlayerState.Disabled)},e.prototype.turnFollowBall=function(){this.state=r.PlayerState.FollowPeriod;var t=new cc.Quat;cc.Quat.fromEuler(t,0,180,0),this.movedirection=new cc.Vec3(0,0,-1),this.node.setRotation(t),l.default.getInstance().emit(r.OperateEvent.PlayerFollowBall,this)},e.prototype.startRuning=function(){if(this.state===r.PlayerState.Idle){this.state=r.PlayerState.RunBackForPlayer,this.playerAnimation.playRun(),this.movedirection=new cc.Vec3(0,0,-1);var t=new cc.Quat;cc.Quat.fromEuler(t,0,180,0),this.node.setRotation(t)}},e.prototype.startFllowBall=function(t){var e=new cc.Vec3(t.x,0,t.z);cc.Vec3.distance(e,new cc.Vec3(this.node.position.x,0,this.node.position.z))>8&&e.z<this.node.position.z?this.turnDsiable():(this.movedirection=this.checkRotate(e),this.state===r.PlayerState.Idle&&this.playerAnimation.playRun(),this.state=r.PlayerState.Follow)},e.prototype.kickOffBall=function(){this.playerAnimation.playKickBall(),this.state=r.PlayerState.Disabled},e.prototype.checkBallIsNear=function(t){if(this.state===r.PlayerState.Follow||this.state===r.PlayerState.RunBackForBall){var e=new cc.Vec3(t.x,0,t.z);return cc.Vec3.distance(new cc.Vec3(this.node.position.x,0,this.node.position.z),e)}return 100},e.prototype.checkRotate=function(t){var e=this.node.position.subtract(t),n=cc.Vec3.ZERO;cc.Vec3.normalize(n,e),n.x=-n.x,n.z=-n.z;var o=new cc.Vec2(n.x,n.z),i=new cc.Vec2(1,0),a=o.signAngle(i),r=Math.floor(cc.misc.radiansToDegrees(a)),l=new cc.Quat;return cc.Quat.fromEuler(l,0,90+r,0),this.node.setRotation(l),n},e.prototype.checkFollowSpeed=function(t){this.startfollowSpeed=t?3:2},e.prototype.startRunBackAfterBall=function(){if(this.state!==r.PlayerState.RunBackForBall){var t=new cc.Quat;cc.Quat.fromEuler(t,0,180,0),this.node.setRotation(t),this.playerAnimation.playRun(),this.state=r.PlayerState.RunBackForBall}},e.prototype.onGameOver=function(){this.gameOver=!0,this.turnDsiable()},e.prototype.onGamePause=function(){this.gamePause=!0},e.prototype.onGameContinue=function(){this.gamePause=!1},e.prototype.update=function(t){if(!this.gameOver&&!this.gamePause)if(this.state===r.PlayerState.Follow){this.startFllowBall(this.ballNode.position),this.playerAnimation.checkPlayRun();var e=cc.Vec3.ZERO;if(cc.Vec3.multiplyScalar(e,this.movedirection,this.startfollowSpeed*t),this.node.setPosition(this.node.position.add(e)),this.startfollowSpeed=this.startfollowSpeed-t*this.followfriction,this.startfollowSpeed<=0)return void this.turnDsiable();var n=new cc.Vec3(this.ballNode.position.x,0,this.ballNode.position.z);if(cc.Vec3.distance(n,this.node.position)<.1)return void this.turnFollowBall()}else if(this.state===r.PlayerState.FollowBall){var o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,this.movedirection,this.followBallSpeed*t),this.node.position=this.node.position.add(o),this.followBallSpeed=this.followBallSpeed-this.followBallFriction*t,this.followBallSpeed<1&&0!=this.followBallFriction&&(this.followBallFriction=0,this.playerAnimation.playRun(.5))}else if(this.state===r.PlayerState.RunBackForBall){o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,new cc.Vec3(0,0,-1),.5*t),this.node.position=this.node.position.add(o);n=new cc.Vec3(this.ballNode.position.x,0,this.ballNode.position.z);cc.Vec3.distance(n,this.node.position)>2&&this.turnDsiable()}else if(this.state===r.PlayerState.RunBackForPlayer){o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,new cc.Vec3(0,0,-1),.6*t),this.node.position=this.node.position.add(o)}else if(this.state===r.PlayerState.FollowPeriod){o=cc.Vec3.ZERO;cc.Vec3.multiplyScalar(o,new cc.Vec3(0,0,-1),2*t),this.node.position=this.node.position.add(o)}else if(this.state===r.PlayerState.Disabled){n=new cc.Vec3(this.ballNode.position.x,0,this.ballNode.position.z);cc.Vec3.distance(n,this.node.position)>4&&(this.state=r.PlayerState.Idle,l.default.getInstance().emit(r.OperateEvent.WhitePlayerGotNextLevel,this))}},i([p(cc.Node)],e.prototype,"playerRender"),i([p(cc.Node)],e.prototype,"numRender"),i([p(cc.Node)],e.prototype,"ballNode"),i([p(cc.Material)],e.prototype,"t1"),i([p(cc.Material)],e.prototype,"t2"),i([p(cc.Material)],e.prototype,"t3"),i([p(cc.Material)],e.prototype,"t4"),i([p(cc.Material)],e.prototype,"t5"),i([p(cc.Material)],e.prototype,"t6"),i([p(cc.Material)],e.prototype,"t7"),i([p(cc.Material)],e.prototype,"t8"),i([p(cc.Material)],e.prototype,"t9"),e=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","./PlayerAnimation":"PlayerAnimation"}],RefreshSceneObject:[function(t,e,n){"use strict";cc._RF.push(e,"5ae145ttvZLAaIjo5g9z90T","RefreshSceneObject");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=cc._decorator,r=a.ccclass,l=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adsnode=null,e.chairsNode=null,e.qiumenNode=null,e.goaladsNode=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.randomsetPosition=function(){var t=Math.random();this.adsnode.setPosition(new cc.Vec3(0,0,-t)),this.chairsNode.setPosition(new cc.Vec3(0,0,-t)),this.qiumenNode.setPosition(new cc.Vec3(0,0,20-t)),this.goaladsNode.setPosition(new cc.Vec3(0,0,t-.5))},e.prototype.revertPosition=function(){Math.random();this.adsnode.setPosition(new cc.Vec3(0,0,0)),this.chairsNode.setPosition(new cc.Vec3(0,0,0)),this.qiumenNode.setPosition(new cc.Vec3(0,0,20)),this.goaladsNode.setPosition(new cc.Vec3(0,0,-.5))},i([l(cc.Node)],e.prototype,"adsnode"),i([l(cc.Node)],e.prototype,"chairsNode"),i([l(cc.Node)],e.prototype,"qiumenNode"),i([l(cc.Node)],e.prototype,"goaladsNode"),e=i([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],Rot:[function(t,e,n){"use strict";cc._RF.push(e,"bb4fd6SfLpDHpkC0cIQyqpn","Rot");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=cc._decorator,r=a.ccclass,l=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.rotation=new cc.Quat,e.euler=new cc.Vec3,e}return o(e,t),e.prototype.start=function(){},e.prototype.update=function(t){this.node.getRotation(this.rotation),this.rotation.toEuler(this.euler),this.euler.x+=50*t,cc.Quat.fromEuler(this.rotation,this.euler.x,this.euler.y,this.euler.z),this.node.setRotation(this.rotation)},i([l(cc.Label)],e.prototype,"label"),i([l],e.prototype,"text"),e=i([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],SettingManager:[function(t,e,n){"use strict";cc._RF.push(e,"6ecf5hyxaxEMLchliuoo7nk","SettingManager");var o=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var i=cc._decorator,a=i.ccclass,r=(i.property,function(){function t(){this.soundOn=!0,this.musicOn=!0,this.bestScore=0}var e;return e=t,t.getInstance=function(){return e.instance||(e.instance=new e,e.instance.initialize()),e.instance},t.prototype.initialize=function(){var t=cc.sys.localStorage.getItem("SoundEnabled");null!==t&&(this.soundOn="true"===t);var e=cc.sys.localStorage.getItem("MusicEnabled");null!==e&&(this.musicOn="true"===e);var n=cc.sys.localStorage.getItem("BestScore");null!==n&&(this.bestScore=n)},t.prototype.getSoundEnabled=function(){return this.soundOn},t.prototype.getMusicEnabled=function(){return this.musicOn},t.prototype.setSoundEnabled=function(t){this.soundOn=t,this.saveSoundChange()},t.prototype.setMusicEnabled=function(t){this.musicOn=t,this.saveSoundChange()},t.prototype.setBestScore=function(t){t>this.bestScore&&(this.bestScore=t,this.saveSoundChange())},t.prototype.saveSoundChange=function(){cc.sys.localStorage.setItem("SoundEnabled",this.soundOn),cc.sys.localStorage.setItem("MusicEnabled",this.musicOn),cc.sys.localStorage.setItem("BestScore",this.bestScore)},t=e=o([a],t)}());n.default=r,cc._RF.pop()},{}],SettingUI:[function(t,e,n){"use strict";cc._RF.push(e,"c2a4aXm5G9DWL33vGHXIpDv","SettingUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../Managers/SettingManager"),r=cc._decorator,l=r.ccclass,c=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeBtn=null,e.musicBtn=null,e.soundBtn=null,e.soundOnSprite=null,e.soundOffSprite=null,e.musicOnSprite=null,e.musicOffSprite=null,e}return o(e,t),e.prototype.onLoad=function(){console.log("-----------onLoad---------");var t=a.default.getInstance().getMusicEnabled(),e=a.default.getInstance().getSoundEnabled();this.setMusicBtnState(t),this.setSoundBtnState(e)},e.prototype.start=function(){this.closeBtn.node.on("click",this.onCloseClick,this),this.soundBtn.node.on("click",this.onSoundClick,this),this.musicBtn.node.on("click",this.onMusicClick,this)},e.prototype.onCloseClick=function(){this.node.active=!1},e.prototype.onSoundClick=function(){var t=!0!==a.default.getInstance().getSoundEnabled();this.setSoundBtnState(t),a.default.getInstance().setSoundEnabled(t)},e.prototype.onMusicClick=function(){var t=!0!==a.default.getInstance().getMusicEnabled();this.setMusicBtnState(t),a.default.getInstance().setMusicEnabled(t)},e.prototype.setMusicBtnState=function(t){this.musicBtn.node.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=!0===t?this.musicOnSprite:this.musicOffSprite},e.prototype.setSoundBtnState=function(t){this.soundBtn.node.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=!0===t?this.soundOnSprite:this.soundOffSprite},i([c(cc.Button)],e.prototype,"closeBtn"),i([c(cc.Button)],e.prototype,"musicBtn"),i([c(cc.Button)],e.prototype,"soundBtn"),i([c(cc.SpriteFrame)],e.prototype,"soundOnSprite"),i([c(cc.SpriteFrame)],e.prototype,"soundOffSprite"),i([c(cc.SpriteFrame)],e.prototype,"musicOnSprite"),i([c(cc.SpriteFrame)],e.prototype,"musicOffSprite"),e=i([l],e)}(cc.Component);n.default=s,cc._RF.pop()},{"../Managers/SettingManager":"SettingManager"}],StartUI:[function(t,e,n){"use strict";cc._RF.push(e,"cd9fbSFwQJJCJGO46vgSShf","StartUI");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=t("../EventDefine"),r=t("../Managers/SettingManager"),l=t("../Com/GameData"),c=t("../Managers/NotificationCenter"),s=cc._decorator,p=s.ccclass,u=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.settingBtn=null,e.startBtn=null,e.goldNum=null,e.cupNumber=null,e.avatarUI=null,e.avatarInstance=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;c.default.getInstance().on("gold_change",function(e,n){t.setGold()},this)},e.prototype.start=function(){var t=this;this.cupNumber.string=r.default.getInstance().bestScore.toString(),this.settingBtn.node.on("click",this.onClickSetting,this),this.startBtn.node.on("click",this.onClickStart,this),cc.find("ClothBtn",this.node).on("click",function(e){null==t.avatarInstance&&(t.avatarInstance=cc.instantiate(t.avatarUI),t.node.addChild(t.avatarInstance)),t.avatarInstance.active=!0}),this.setGold()},e.prototype.setGold=function(){cc.find("GoldLayout/GoldNum",this.node).getComponent(cc.Label).string=l.default.GetInstance().gold.toString()},e.prototype.onClickStart=function(){var t=new cc.Event.EventCustom(a.UIEvents.StartUIClickStartEvent,!0);this.node.dispatchEvent(t)},e.prototype.onClickSetting=function(){var t=new cc.Event.EventCustom(a.UIEvents.StartUIClickSettingEvent,!0);this.node.dispatchEvent(t)},i([u(cc.Button)],e.prototype,"settingBtn"),i([u(cc.Button)],e.prototype,"startBtn"),i([u(cc.Label)],e.prototype,"goldNum"),i([u(cc.Label)],e.prototype,"cupNumber"),i([u(cc.Prefab)],e.prototype,"avatarUI"),e=i([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../Com/GameData":"GameData","../EventDefine":"EventDefine","../Managers/NotificationCenter":"NotificationCenter","../Managers/SettingManager":"SettingManager"}],TestScene:[function(t,e,n){"use strict";cc._RF.push(e,"771c2GRcWlE+YHdZde1EAbb","TestScene");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};n.__esModule=!0;var a=cc._decorator,r=a.ccclass,l=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return o(e,t),e.prototype.start=function(){console.log("hello")},i([l(cc.Label)],e.prototype,"label"),i([l],e.prototype,"text"),e=i([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}]},{},["CameraFollow","AdCom","GameData","List","EventDefine","ConfigsManager","NotificationCenter","SettingManager","RefreshSceneObject","Rot","BallCollider","BallController","BallGoal","GameScene","NPCCollider","NPCKeeper","NPCPlayer","Player","PlayerAnimation","TestScene","AvatarUI","EndUI","GameUI","GameUIController","GamingUI","NewSkinUI","PauseUI","SettingUI","StartUI"]);